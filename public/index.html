<!DOCTYPE html>
<html>
  <head>
    <title>Chat app</title>
    <style>
        #container {
          width: 700px;
          margin: 0 auto;
        }
        .chat-input {
          width: 300px;
          height: 35px;
          border: solid 1px #444;
        }
        .chat-submit {
          width: 50px;
          height: 35px;
          border: solid 1px #444;
        }
        .chat-window {
          height: 300px;
          width: 400px;
        }
        #chatSection {
          float: left;
          border: 1px grey solid;
          border-radius: 10px;
          padding: 10px;
        }
      </style>
  </head>
  <body>
    <div id="container">
      <div id="chatSection">
        <div class="chat-window">
        </div>
        <form class="chat-form">
          <label class="chat-label">
            Enter a message:
            <input type="text" class="chat-input" />
          </label>
          <input type="submit" class="chat-submit" value="enter" />
        </form>
      </div>
    </div>

    <script src="socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      const chat = document.querySelector('.chat-form');
      const input = document.querySelector('.chat-input');
      const div = document.querySelector('.chat-window');
      const urlparams = new URLSearchParams(window.location.search);
      const name = urlparams.get('name');


      chat.addEventListener('submit', (event)=> {
          event.preventDefault();
          socket.emit('chat', input.value);
          input.value='';
      })

      socket.emit('register', {
        name: name
      })

      socket.on('personal', (id)=> {
          console.log(`my id is ${id}`);
      })

      socket.on('chat', (data)=>{
          const h3 = document.createElement('h3');
          h3.textContent = data;
          div.appendChild(h3);
      })

    </script>
  </body>
</html>